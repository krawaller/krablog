
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Puzzle app step 3 - revving up the engine - Krawaller webdev blog</title>
  <meta name="author" content="Krawaller">

  
  <meta name="description" content="Excusing the sound of silence And suddenly a whole month went by! But we haven&#8217;t just been idling around playing Carcassone all day (at least &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://krawaller.github.com/krablog/puzzle-app-step-3-revving-up-the-engine/">
  <link href="/krablog/favicon.png" rel="icon">
  <link href="/krablog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/krablog/javascripts/modernizr-2.0.js"></script>
  <script src="/krablog/javascripts/ender.js"></script>
  <script src="/krablog/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/krablog/atom.xml" rel="alternate" title="Krawaller webdev blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/krablog/">Krawaller webdev blog</a></h1>
  
    <h2>Musings on programming in general and JavaScript in particular</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/krablog/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:krawaller.github.com/krablog" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/krablog/">Blog</a></li>
  <li><a href="/krablog/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Puzzle App Step 3 - Revving Up the Engine</h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-07-03T00:00:00+02:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


<div class="entry-content"><h3>Excusing the sound of silence</h3>
<p>And suddenly a whole month went by! But we haven&#8217;t just been idling around playing <a href="http://carcassonneapp.com/" title="Carcassonne app official homepage">Carcassone</a> all day (at least not just) - this past month has seen several wheels being set in motion;</p>
<ul>
<li>An <strong>iPad/iOS4-friendly version of <a href="http://blog.krawaller.se/tag/golingo" title="Posts on Golingo">Golingo</a></strong> is waiting in the wings! Come on, little brother, type faster!</li>
<li>We&#8217;re awaiting Apple&#8217;s approval for our next AppStore application [edit: app is now live, read announcement <a href="http://blog.krawaller.se/systemet">here</a>] - an <strong>inofficial app for <a href="http://www.systembolaget.se/hem/" title="Systembolaget">Systembolaget</a></strong> (where swedes go buy their alcohol, since we&#8217;re not trusted to do so without government supervision). There <a href="http://itunes.apple.com/se/app/hittabolaget/id328888218?mt=8" title="HittaBolaget appstore link">already is one</a> on the market, but our not-so-objective opinion is that we blow that out of the water since&nbsp;Titanium &gt; ObjectiveC (and also&nbsp;good design &gt; bad design).</li>
<li>Communications are underway with the manufacturers behind our very favourite <strong>boardgame</strong> regarding taking it to the iPad/iPhone (inspired by the brilliant appification of Carcassone, which we&#8217;re absolutely not playing all day all the time). Hopefully we can spill some more beans on that in the somewhat near future!</li>
<li>Continuing the trend of placing ourselves at risk of severe starstruckness, we&#8217;ve also begun development of the <strong>official app for our favourite metal band</strong>. Huge amounts of fun, and having an excuse to communicate with these long-time heroes of ours is simply awesome. Further beanspilling to follow here too [edit: check the related posts <a href="http://blog.krawaller.se/tag/tristania">here</a>] .&nbsp;</li>
<li>Our biggest pastime, however, has been <strong>involvement with a very promising startup</strong>, spearheaded by a driven entrepeneur duo with a great idea and the know-how to make it happen. Seeing these guys in action has been a privilige; we might have some badass technical knowhow, but direction, ambition, organisation, efficiency and all those adjectives - not so much. So being able to piggyback on them has been a very educative ride. And, you guessed it; more beans later.&nbsp;</li>
</ul>
<p>All this action invariably meant less playtime for our less serious (read: turnover-potent) inhouse project, which demoted our puzzle game to the back burner. But before <span style="text-decoration: line-through;">Carcassone took us over completely</span> things got too busy, we did managed to make quite a bit of progress, which is what we wanted to share in this post!</p>
<h3>Analyse this</h3>
<p>First and foremost, the<strong> analyser module is finished</strong>. It turned out to be an almost AliceInWonderlandesque journey into some rather esotheric recursive gymnastics, so if you&#8217;re into that sort of thing, do dive into the code and check it out (the code repository can be found&nbsp;<a href="http://github.com/krawaller/labyrinth" title="App Github repository" target="_blank">here</a>, if we haven&#8217;t already said so).</p>
<p>The idea is detailed in the previous posts, but mainly the idea was to have all game logic in an analyser function that calculates all possible states in a level, including the transitions between these states. The actual <strong>player</strong> module (yet to be finished, but a scaffold is up) therefore doesn&#8217;t need to contain any logic, but simply renders the different states and moves the player between them as he gives his commands. This backward design means&#8230;</p>
<ul>
<li>Beautiful <strong>separation of concerns</strong> in the codebase</li>
<li>We can programmatically check the <strong>integrity</strong> of a level, to see if it&#8217;s actually solvable</li>
<li>Better yet, we can also calculate the <strong>difficulty</strong>, by checking                  
<ul>
<li>the <strong>minimum amount of steps needed</strong> to reach a perfect solution</li>
<li>how many <strong>different branches</strong> there are</li>
<li>frequency of <strong>dead ends</strong> and <strong>deathtraps</strong> </li>
</ul>
</li>
<li>This also means that we can include a <strong>level editor</strong> in the game, and give immediate feedback to the level designer.</li>
<li>With some work it should also be possible to <strong>randomise</strong> levels.</li>
</ul>
<h3>Prototyping</h3>
<p>Ok, enough babbling - here&#8217;s the game in action (if the iframe doesn&#8217;t play nice, here&#8217;s a <a href="http://dl.dropbox.com/u/2287145/labdemo/demo.html" title="labyrinth puzzle game demo" target="_blank">link directly to the demo</a>), using our scaffolded and not-that-lovingly crafted player module. The level isn&#8217;t that interesting, but serves its purpose as a proof of concept rather nicely.&nbsp;Rule-wise&nbsp;it is very simple; whenever you make a move, all player marbles will fall as far as possible in the chosen direction.&nbsp;</p>
<p><iframe src="http://dl.dropbox.com/u/2287145/labdemo/demo.html" height="300px" width="400px"></iframe></p>
<p>Here&#8217;s a quick rundown on the different objects in the level:</p>
<ul>
<li>The <strong>yellow marbles</strong> are your player objects, which you move with the arrow keys (or touches if you&#8217;re on an iphone/ipad). The game keeps going as long as at least one marble is still in play. In this version, nothing at all happens when two marbles overlap, as we couldn&#8217;t decide if they should block or kill each other.</li>
<li>The goal is to get them all to the <strong>red heart</strong>&nbsp;(the meaning of life is love?).&nbsp;</li>
<li>For a perfect solution you must also pick up all the <strong>valuables</strong>, of which there&#8217;re two kinds:                 
<ul>
<li>A <strong>small coin</strong>, which is simply picked up as you pass over it</li>
<li>A <strong>large star</strong>, which is picked up but makes the ball stop in the process.&nbsp;</li>
</ul>
</li>
<li>The blue rotating asterisks are <strong>teleports</strong>, which immediately moves the marble to another position (but doesn&#8217;t interrupt the motion).</li>
<li>The blue square is a <strong>block of ice</strong>, which will gradually break as you collide with it, needing two hits to disappear completely.</li>
<li>We&#8217;re not quite sure what the <strong>yellow sun symbol</strong> is supposed to represent, but it stops the marble upon entry.</li>
<li>The green triangle is a <strong>locked door</strong>, which is impassable until you&#8217;ve collected&#8230;</li>
<li>&#8230;the green digit 1, which is a <strong>key</strong>.</li>
<li>The <strong>curved wall</strong> will of course change the direction of the marble accordingly.</li>
<li>The <strong>red arrow</strong> can only be passed in the direction it is pointing, all other paths are blocked. Not sure if it is intiutive for it to block just the opposite direction or all three non-pointing directions, the jury is still out on that.</li>
<li>The <strong>grey square</strong> does nothing except blocking, and is thus pretty uninteresting and useless. We&#8217;ll most likely not use it further.</li>
</ul>
<h3>The data structure in action</h3>
<p>None of these behaviours are hard-coded into the game logic. Instead they&#8217;re all defined in the level data object, which is made possible due to the <strong>abstract design</strong> we laid out in the <a href="http://blog.krawaller.se/puzzle-app-step-2-data-structure" title="Puzzle app step 2 - Data structure">previous post</a>. Now, whether or not that was a good idea I&#8217;m still not sure, since it made the engine tougher to code. It does however allow for a lot of agility now, as it would be easy to think up a new labyrinth denizen and define its behaviour with pure data, without having to touch the logic code.</p>
<p>The behaviours are in essence a description of what will happen upon the collision of two objects. For example, here&#8217;s the definition of a collision between a player marble (plr) and a key square:</p>
<script src="http://gist.github.com/459206.js?file=collision-key.js"></script>
<p>Collision with the gate then looks like this:</p>
<script src="http://gist.github.com/459206.js?file=collision-gate.js"></script>
<p>While not rocket science, this system allows us to easily accomodate these new ideas as they come along. The initial idea was to allow the level editor to define new objects here, but probably we&#8217;ll stick with predefining lots of objects, and limiting the editor to choosing between these.</p>
<h3>The missing pieces of the puzzle</h3>
<p>Obviously, there&#8217;s still a long way to go before we have anything close to a finished product:</p>
<ul>
<li>Although a little slab of (CSS-only!) paint made a huge difference, we need to <strong>work on the graphics</strong>. We&#8217;re not at all sure how to approach this, but it will definitely still be CSS3-based as far as possible, meaning a simple yet hopefully elegant design.</li>
<li>We still have to make the <strong>app infrastructure</strong> to contain the game.</li>
<li>The aforementioned <strong>level editor</strong> is probably a rather huge project in and of itself, so that will also take some time.</li>
<li>As is the <strong>randomiser</strong>, if it is at all possible.</li>
<li>We also need some <strong>more ideas regarding in-game objects</strong>. Having multiple player balls is a good one, but we need to freshen it all up some more. Balls travelling against gravity, pushable boxes, the list goes on and on.</li>
</ul>
<p>And since all the excuses we made at the beginning of the post applies for the foreseeable future as well, completion of the labyrinth puzzle game is definitely far off. But, we&#8217;re slowly but surely getting there!</p>
<p>Also, again: Carcassone is a brilliant game! The application rendition really does the real-life counterpart justice. Buy it, play it, send fan-mail to the developers!&nbsp;</p>
<ul>
</ul>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">David</span></span>

      








  


<time datetime="2010-07-03T00:00:00+02:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2010</time>
      

<span class="categories">
  
    <a class='category' href='/krablog/categories/development/'>development</a>, <a class='category' href='/krablog/categories/labyrinth/'>labyrinth</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://krawaller.github.com/krablog/puzzle-app-step-3-revving-up-the-engine/" data-via="krawaller" data-counturl="http://krawaller.github.com/krablog/puzzle-app-step-3-revving-up-the-engine/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/krablog/opensourcing-golingo/" title="Previous Post: Opensourcing Golingo">&laquo; Opensourcing Golingo</a>
      
      
        <a class="basic-alignment right" href="/krablog/systemet/" title="Next Post: Systemet">Systemet &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/krablog/testing-backbone-objects/">Testing Backbone Objects</a>
      </li>
    
      <li class="post">
        <a href="/krablog/slides-form-sfis-talk-october-2012/">Slides form SFIS talk October 2012</a>
      </li>
    
      <li class="post">
        <a href="/krablog/software-passion/">Software Passion</a>
      </li>
    
      <li class="post">
        <a href="/krablog/coffeescript-overview-and-resource-inventory/">CoffeeScript overview and resource inventory</a>
      </li>
    
      <li class="post">
        <a href="/krablog/krawaller-real-life-appearances/">Krawaller real-life appearances</a>
      </li>
    
  </ul>
</section>
<section>
	<h1>Categories</h1>
	<ul id="category-list"><li><a href='http://krawaller.github.com/krablog/categories/auktionera'>auktionera (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/backbone'>Backbone (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/coffeescript'>coffeescript (2)</a></li><li><a href='http://krawaller.github.com/krablog/categories/couchone'>couchone (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/development'>development (12)</a></li><li><a href='http://krawaller.github.com/krablog/categories/github'>github (2)</a></li><li><a href='http://krawaller.github.com/krablog/categories/golingo'>golingo (3)</a></li><li><a href='http://krawaller.github.com/krablog/categories/instaviz'>instaviz (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/ipad'>ipad (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/ithoughts'>ithoughts (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/jasmine'>Jasmine (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/kranium'>kranium (2)</a></li><li><a href='http://krawaller.github.com/krablog/categories/labyrinth'>labyrinth (3)</a></li><li><a href='http://krawaller.github.com/krablog/categories/livetanium'>livetanium (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/mobilesafari'>mobilesafari (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/nodejs'>nodejs (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/omnigraffle'>omnigraffle (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/promotejs'>promotejs (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/review'>review (5)</a></li><li><a href='http://krawaller.github.com/krablog/categories/ria-university-course'>RIA_university_course (2)</a></li><li><a href='http://krawaller.github.com/krablog/categories/sinon'>Sinon (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/struct'>struct (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/systemet'>systemet (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/talk'>talk (3)</a></li><li><a href='http://krawaller.github.com/krablog/categories/testing'>Testing (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/titanium'>titanium (10)</a></li><li><a href='http://krawaller.github.com/krablog/categories/tiview'>tiview (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/tradera'>tradera (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/travelhack'>travelhack (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/tristania'>tristania (2)</a></li><li><a href='http://krawaller.github.com/krablog/categories/tweetanium'>tweetanium (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/txtv'>txtv (1)</a></li><li><a href='http://krawaller.github.com/krablog/categories/yql'>yql (3)</a></li></ul>
</section>
<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("krawaller", 4, false);
    });
  </script>
  <script src="/krablog/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/krawaller" class="twitter-follow-button" data-show-count="false">Follow @krawaller</a>
  
</section>


  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Krawaller -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'krawaller';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
